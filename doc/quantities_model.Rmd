---
title: "Model Quantities"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(drake)
library(tidyverse)
library(brms)
loadd(mod_comb, data_mice_compl, zi_vars, pois_vars)
```

Bayesian R-squared
```{r}
bayes_R2(mod_comb, summary = TRUE)
```

get means and predict doubling for each vars
```{r}
# add interaction to data_mice_compl
data_mice_compl <- data_mice_compl %>% 
  mutate("ln_livestock_consumption_kg_per_capita:ln_gdp_per_capita" = ln_livestock_consumption_kg_per_capita * ln_gdp_per_capita)

amr_means <- colMeans(as.matrix(data_mice_compl[,unique(c(zi_vars, pois_vars))])) %>%
  enframe() %>%
  pivot_wider(names_from = name, values_from = value)

mean_estimate <- predict(mod_comb, newdata = amr_means, summary = TRUE)

imap(amr_means, function(x, y){
  dbl_estimate <- amr_means %>%
    mutate(!!y := ifelse(str_detect(y, "ln_"), log(exp(x) * 2), x * 2)) %>%
    predict(mod_comb, newdata = .)
  dbl_estimate[1]/mean_estimate[1]
})

```

